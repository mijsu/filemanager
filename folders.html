<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Folders</title>
  <link rel="stylesheet" href="style.css">
  <script type="text/javascript" src="app.js" defer></script>
</head>
<body>
  <nav id="sidebar">
    <ul>
      <li>
        <span class="logo">CUTTINGDAWGZ</span>
        <button onclick=toggleSidebar() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
      </li>
      <li class="active">
        <a href="index.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M240-200h120v-200q0-17 11.5-28.5T400-440h160q17 0 28.5 11.5T600-400v200h120v-360L480-740 240-560v360Zm-80 0v-360q0-19 8.5-36t23.5-28l240-180q21-16 48-16t48 16l240 180q15 11 23.5 28t8.5 36v360q0 33-23.5 56.5T720-120H560q-17 0-28.5-11.5T520-160v-200h-80v200q0 17-11.5 28.5T400-120H240q-33 0-56.5-23.5T160-200Zm320-270Z"/></svg>
          <span>Home</span>
        </a>
      </li>
      <li>
        <a href="dashboard.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M520-640v-160q0-17 11.5-28.5T560-840h240q17 0 28.5 11.5T840-800v160q0 17-11.5 28.5T800-600H560q-17 0-28.5-11.5T520-640ZM120-480v-320q0-17 11.5-28.5T160-840h240q17 0 28.5 11.5T440-800v320q0 17-11.5 28.5T400-440H160q-17 0-28.5-11.5T120-480Zm400 320v-320q0-17 11.5-28.5T560-520h240q17 0 28.5 11.5T840-480v320q0 17-11.5 28.5T800-120H560q-17 0-28.5-11.5T520-160Zm-400 0v-160q0-17 11.5-28.5T160-360h240q17 0 28.5 11.5T440-320v160q0 17-11.5 28.5T400-120H160q-17 0-28.5-11.5T120-160Zm80-360h160v-240H200v240Zm400 320h160v-240H600v240Zm0-480h160v-80H600v80ZM200-200h160v-80H200v80Zm160-320Zm240-160Zm0 240ZM360-280Z"/></svg>
          <span>Dashboard</span>
        </a>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h207q16 0 30.5 6t25.5 17l57 57h320q33 0 56.5 23.5T880-640v400q0 33-23.5 56.5T800-160H160Zm0-80h640v-400H447l-80-80H160v480Zm0 0v-480 480Zm400-160v40q0 17 11.5 28.5T600-320q17 0 28.5-11.5T640-360v-40h40q17 0 28.5-11.5T720-440q0-17-11.5-28.5T680-480h-40v-40q0-17-11.5-28.5T600-560q-17 0-28.5 11.5T560-520v40h-40q-17 0-28.5 11.5T480-440q0 17 11.5 28.5T520-400h40Z"/></svg>
          <span>Create</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu">
          <div>
            <li><a href="folders.html">Folder</a></li>
            <li><a href="#">Document</a></li>
            <li><a href="#">Project</a></li>
          </div>
        </ul>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m221-313 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-228q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm0-320 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-548q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm339 353q-17 0-28.5-11.5T520-320q0-17 11.5-28.5T560-360h280q17 0 28.5 11.5T880-320q0 17-11.5 28.5T840-280H560Zm0-320q-17 0-28.5-11.5T520-640q0-17 11.5-28.5T560-680h280q17 0 28.5 11.5T880-640q0 17-11.5 28.5T840-600H560Z"/></svg>
          <span>Todo-Lists</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu">
          <div>
            <li><a href="#">Work</a></li>
            <li><a href="#">Private</a></li>
            <li><a href="#">Coding</a></li>
            <li><a href="#">Gardening</a></li>
            <li><a href="#">School</a></li>
          </div>
        </ul>
      </li>
      <li>
        <a href="calendar.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-40q0-17 11.5-28.5T280-880q17 0 28.5 11.5T320-840v40h320v-40q0-17 11.5-28.5T680-880q17 0 28.5 11.5T720-840v40h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Zm280 240q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm-160 0q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm320 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM480-240q-17 0-28.5-11.5T440-280q0-17 11.5-28.5T480-320q17 0 28.5 11.5T520-280q0 17-11.5 28.5T480-240Zm-160 0q-17 0-28.5-11.5T280-280q0-17 11.5-28.5T320-320q17 0 28.5 11.5T360-280q0 17-11.5 28.5T320-240Zm320 0q-17 0-28.5-11.5T600-280q0-17 11.5-28.5T640-320q17 0 28.5 11.5T680-280q0 17-11.5 28.5T640-240Z"/></svg>
          <span>Calendar</span>
        </a>
      </li>
      <li>
        <a href="profile.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-240v-32q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v32q0 33-23.5 56.5T720-160H240q-33 0-56.5-23.5T160-240Zm80 0h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg>
          <span>Profile</span>
        </a>
      </li>
    </ul>
  </nav>
  
  <main>
    <h1>Manage Folders</h1>
    <button onclick="openModal()" class="create-btn">Create Folder</button>

    <!-- Create Folder Modal -->
    <div id="folder-modal" class="modal">
        <div class="modal-content">
            <h2>Create New Folder</h2>
            <input type="text" id="folder-name" placeholder="Enter folder name">
            <button onclick="createFolder()" class="create-folder-btn">Create Folder</button>
        </div>
    </div>

    <!-- Folder Action Modal (Rename, Delete, Share) -->
    <div id="folder-action-modal" class="modal">
        <div class="modal-content">
            <h2>Folder Actions</h2>
            <button id="rename-btn" onclick="openRenameModal()">Rename</button>
            <button id="delete-btn" onclick="openDeleteModal()">Delete</button>
            <button id="share-btn" onclick="openShareModal()">Share</button>
            <button id="encrypt-btn" onclick="openEncryptModal()">Encrypt/Decrypt</button>
        </div>
    </div>

    <!-- Rename Folder Modal -->
    <div id="rename-modal" class="modal">
        <div class="modal-content">
            <h2>Rename Folder</h2>
            <input type="text" id="rename-folder-name" placeholder="Enter new folder name">
            <button onclick="renameFolderConfirm()" class="create-folder-btn">Rename Folder</button>
            <button onclick="closeRenameModal()" class="cancel-btn">Cancel</button>
        </div>
    </div>

    <!-- Delete Folder Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <h2>Are you sure you want to delete this folder?</h2>
            <button onclick="deleteFolderConfirm()" class="delete-btn">Delete</button>
            <button onclick="closeDeleteModal()" class="cancel-btn">Cancel</button>
        </div>
    </div>

    <!-- Share Folder Modal -->
    <div id="share-modal" class="modal">
        <div class="modal-content">
            <h2>Share Folder</h2>
            <input type="text" id="share-email" placeholder="Enter email address">
            <label for="access-level">Access Level:</label>
            <select id="access-level">
                <option value="view">View Only</option>
                <option value="edit">Edit</option>
            </select>
            <button onclick="generateShareLink()" class="btn-action share">Generate Share Link</button>
            <button onclick="closeShareModal()" class="cancel-btn">Cancel</button>
        </div>
    </div>

    <!-- Encryption/Decryption Modal -->
    <div id="encryption-modal" class="modal">
        <div class="modal-content">
            <h2 id="encryption-message"></h2>
            <button onclick="closeEncryptionModal()" class="cancel-btn">Close</button>
        </div>
    </div>

    <!-- Decryption Modal (For inputting decryption key) -->
    <div id="decryption-modal" class="modal">
        <div class="modal-content">
            <h2>Enter Decryption Key</h2>
            <input type="text" id="decryption-key" placeholder="Enter decryption key">
            <button onclick="decryptFolder()" class="btn-action">Decrypt</button>
            <button onclick="closeDecryptionModal()" class="cancel-btn">Cancel</button>
        </div>
    </div>

    <!-- Folder Container -->
    <div id="folder-container" class="folder-container">
        <!-- Folders will be listed here -->
    </div>
</main>

<script>
let folders = [];
let selectedFolder = null;  // Store the currently selected folder
let pressTimer = null; // Timer to detect long press

// Open the Create Folder modal
function openModal() {
    document.getElementById("folder-modal").style.display = "flex";  // Show modal
}

// Close the Create Folder modal
function closeModal() {
    document.getElementById("folder-modal").style.display = "none";  // Hide modal
}

// Create Folder function
function createFolder() {
    const folderName = document.getElementById("folder-name").value;
    if (folderName) {
        const folder = { name: folderName, id: Date.now(), encrypted: false, encryptionKey: null };
        folders.push(folder);
        renderFolders();
        closeModal();  // Close the modal after creating the folder
    }
}

// Render folders on the page
function renderFolders() {
    const folderContainer = document.getElementById("folder-container");
    folderContainer.innerHTML = "";
    folders.forEach(folder => {
        const folderDiv = document.createElement("div");
        folderDiv.classList.add("folder");
        folderDiv.id = folder.id;
        folderDiv.innerHTML = `
            <div class="folder-header">
                <span onmousedown="startPress(${folder.id})" onmouseup="endPress()" onmouseleave="endPress()" onclick="selectFolder(${folder.id})" style="display: flex; align-items: center; gap: 8px;">
                    <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#e8eaed">
                        <path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h207q16 0 30.5 6t25.5 17l57 57h320q33 0 56.5 23.5T880-640v400q0 33-23.5 56.5T800-160H160Zm0-80h640v-400H447l-80-80H160v480Zm0 0v-480 480Zm400-160v40q0 17 11.5 28.5T600-320q17 0 28.5-11.5T640-360v-40h40q17 0 28.5-11.5T720-440q0-17-11.5-28.5T680-480h-40v-40q0-17-11.5-28.5T600-560q-17 0-28.5 11.5T560-520v40h-40q-17 0-28.5 11.5T480-440q0 17 11.5 28.5T520-400h40Z"/>
                    </svg>
                    <span style="font-size: 15px;">${folder.name}</span>
                </span>
            </div>
        `;
        folderContainer.appendChild(folderDiv);

        // Add touch event listeners for mobile compatibility
        addMobileEventListeners(folder.id);
    });
}


// Select folder logic
function selectFolder(id) {
    // Deselect previously selected folder
    if (selectedFolder) {
        document.getElementById(selectedFolder).classList.remove("selected");
    }

    // Select new folder
    selectedFolder = id;
    document.getElementById(selectedFolder).classList.add("selected");
}

// Start long press detection for both touch and mouse events
function startPress(id) {
    pressTimer = setTimeout(function () {
        // Show folder actions in a modal after 500ms hold
        openFolderActionModal(id);
    }, 500);
}

// End long press detection for both touch and mouse events
function endPress() {
    clearTimeout(pressTimer); // Cancel the timer if the press is released too soon
}

// Add touch event listeners for mobile compatibility
function addMobileEventListeners(folderId) {
    const folderElement = document.getElementById(folderId);
    folderElement.addEventListener("touchstart", function (event) {
        event.preventDefault(); // Prevent default touch action
        startPress(folderId);
    });
    folderElement.addEventListener("touchend", function () {
        endPress();
    });
}

// Open Folder Action Modal (Rename, Delete, Share, Encrypt/Decrypt)
function openFolderActionModal(id) {
    selectedFolder = id;
    const folder = folders.find(f => f.id === id);

    document.getElementById("rename-btn").style.display = folder.encrypted ? "none" : "inline-block";
    document.getElementById("delete-btn").style.display = folder.encrypted ? "none" : "inline-block";
    document.getElementById("share-btn").style.display = folder.encrypted ? "none" : "inline-block";
    document.getElementById("encrypt-btn").textContent = folder.encrypted ? "Decrypt" : "Encrypt";

    document.getElementById("folder-action-modal").style.display = "flex";  // Show modal
}

// Close Folder Action Modal
function closeFolderActionModal() {
    document.getElementById("folder-action-modal").style.display = "none";  // Hide modal
}

// Open Rename Folder modal
function openRenameModal() {
    const folder = folders.find(f => f.id === selectedFolder);
    if (folder && !folder.encrypted) {
        document.getElementById("rename-folder-name").value = folder.name;
        document.getElementById("rename-modal").style.display = "flex";  // Show modal
    }
}

// Close Rename Folder modal
function closeRenameModal() {
    document.getElementById("rename-modal").style.display = "none";  // Hide modal
}

// Rename Folder confirmation
function renameFolderConfirm() {
    const folder = folders.find(f => f.id === selectedFolder);
    if (folder) {
        const newName = document.getElementById("rename-folder-name").value;
        folder.name = newName;
        renderFolders();
        closeRenameModal();  // Close modal after renaming
        closeFolderActionModal();  // Close folder action modal
    }
}

// Open Delete Folder modal
function openDeleteModal() {
    const folder = folders.find(f => f.id === selectedFolder);
    if (folder && !folder.encrypted) {
        document.getElementById("delete-modal").style.display = "flex";  // Show modal
    }
}

// Close Delete Folder modal
function closeDeleteModal() {
    document.getElementById("delete-modal").style.display = "none";  // Hide modal
}

// Delete Folder confirmation
function deleteFolderConfirm() {
    folders = folders.filter(f => f.id !== selectedFolder);
    renderFolders();
    closeDeleteModal();  // Close modal after deleting
    closeFolderActionModal();  // Close folder action modal
}

// Open Share Folder modal
function openShareModal() {
    const folder = folders.find(f => f.id === selectedFolder);
    if (folder) {
        document.getElementById("share-modal").style.display = "flex";  // Show modal
    }
}

// Close Share Folder modal
function closeShareModal() {
    document.getElementById("share-modal").style.display = "none";  // Hide modal
}

// Generate Share Link function
function generateShareLink() {
    const email = document.getElementById("share-email").value;
    const accessLevel = document.getElementById("access-level").value;

    if (email) {
        alert(`Folder shared with ${email} with ${accessLevel} access`);
        closeShareModal();
        closeFolderActionModal();  // Close folder action modal
    } else {
        alert("Please enter a valid email.");
    }
}

// Open Encrypt/Decrypt Folder modal
function openEncryptModal() {
    const folder = folders.find(f => f.id === selectedFolder);
    if (folder) {
        if (!folder.encrypted) {
            const encryptionKey = generateRandomKey();
            folder.encryptionKey = encryptionKey;
            folder.encrypted = true;
            showEncryptionMessage(`Folder encrypted with key: ${encryptionKey}`);
        } else {
            openDecryptionModal();  // Show the decryption modal
        }
        renderFolders();  // Re-render the folder list after encryption/decryption
        closeFolderActionModal();  // Close folder action modal
    }
}

// Open Decryption Modal for inputting decryption key
function openDecryptionModal() {
    const folder = folders.find(f => f.id === selectedFolder);
    if (folder) {
        document.getElementById("decryption-modal").style.display = "flex";  // Show modal
    }
}

// Close Decryption Modal
function closeDecryptionModal() {
    document.getElementById("decryption-modal").style.display = "none";  // Hide modal
}

// Handle Decryption logic
function decryptFolder() {
    const folder = folders.find(f => f.id === selectedFolder);
    const decryptionKey = document.getElementById("decryption-key").value;

    if (decryptionKey === folder.encryptionKey) {
        folder.encrypted = false;
        folder.encryptionKey = null;
        showEncryptionMessage("Folder decrypted successfully.");
    } else {
        showEncryptionMessage("Incorrect key. Decryption failed.");
    }

    renderFolders();  // Re-render folders after decryption
    closeDecryptionModal();  // Close decryption modal
}

// Generate a random 24-character encryption key
function generateRandomKey() {
    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    let key = '';
    for (let i = 0; i < 24; i++) {
        key += characters.charAt(Math.floor(Math.random() * characters.length));
    }
    return key;
}

// Show Encryption/Decryption message in modal
function showEncryptionMessage(message) {
    document.getElementById("encryption-message").textContent = message;
    document.getElementById("encryption-modal").style.display = "flex";  // Show modal
}

// Close Encryption Modal
function closeEncryptionModal() {
    document.getElementById("encryption-modal").style.display = "none";  // Hide modal
}

// Close modal when clicking outside of it
window.addEventListener('click', function(event) {
    const folderModal = document.getElementById('folder-modal');
    const folderActionModal = document.getElementById('folder-action-modal');
    const renameModal = document.getElementById('rename-modal');
    const deleteModal = document.getElementById('delete-modal');
    const shareModal = document.getElementById('share-modal');
    const encryptionModal = document.getElementById('encryption-modal');
    const decryptionModal = document.getElementById('decryption-modal');

    // Check if the clicked target is the modal container (background)
    if (event.target === folderModal || event.target === folderActionModal || event.target === renameModal || event.target === deleteModal || event.target === shareModal || event.target === encryptionModal || event.target === decryptionModal) {
        closeModal();
        closeFolderActionModal();
        closeRenameModal();
        closeDeleteModal();
        closeShareModal();
        closeEncryptionModal();
        closeDecryptionModal();
    }
});
</script>




      
</body>
</html>
